dbManager.Command.CommandText = @"SET IDENTITY_INSERT  studentinfo ON;merge into studentinfo  as Target
using StudentInfo_Temp as Source
on Target.[Form Number] = Source.[Form Number]
when matched then 
update 

Set Target.[Academic Program]=Source.[Academic Program],Target.[Department]=Source.[Department],Target.Surname=Source.Surname,Target.[First Name]=Source.[First Name],Target.[Other Name]=Source.[Other Name],Target.Gender=Source.Gender,Target.[Date of Birth]=Source.[Date of Birth],Target.[Home Address]=Source.[Home Address],Target.[Phone Number]=Source.[Phone Number],
Target.[Email Address]=Source.[Email Address],Target.[State of Origin]=Source.[State of Origin],Target.[Local Govt Area]=Source.[Local Govt Area],Target.Picture=Source.Picture,Target.[JAMB Reg Number]=Source.[JAMB Reg Number],Target.[JAMB Subjects]=Source.[JAMB Subjects],Target.[JAMB UTME Score]=Source.[JAMB UTME Score],Target.[CBT Score]=Source.[CBT Score],Target.[Admission Score]=Source.[Admission Score],
Target.[First O'Level Exam Type]=Source.[First O'Level Exam Type],Target.[First O'Level Exam Month]=Source.[First O'Level Exam Month],Target.[First O'Level Exam Number]=Source.[First O'Level Exam Number],Target.[First O'Level Exam Year]=Source.[First O'Level Exam Year],Target.[Subject 1]=Source.[Subject 1],Target.[Grade 1]=Source.[Grade 1],Target.[Subject 2]=Source.[Subject 2],Target.[Grade 2]=Source.[Grade 2],
Target.[Subject 3]=Source.[Subject 3],Target.[Grade 3]=Source.[Grade 3],Target.[Subject 4]=Source.[Subject 4],Target.[Grade 4]=Source.[Grade 4],Target.[Subject 5]=Source.[Subject 5],Target.[Grade 5]=Source.[Grade 5],Target.[Subject 6]=Source.[Subject 6],Target.[Grade 6]=Source.[Grade 6],Target.[Subject 7]=Source.[Subject 7],Target.[Grade 7]=Source.[Grade 7],Target.[Subject 8]=Source.[Subject 8],Target.[Grade 8]=Source.[Grade 8],
Target.[Second O'Level Exam Type]=Source.[Second O'Level Exam Type],Target.[Second O'Level Exam Month]=Source.[Second O'Level Exam Month],Target.[Second O'Level Exam Number]=Source.[Second O'Level Exam Number],Target.[Second O'Level Exam Year]=Source.[Second O'Level Exam Year],Target.[Subject 9]=Source.[Subject 9],Target.[Grade 9]=Source.[Grade 9],Target.[Subject 10]=Source.[Subject 10],Target.[Grade 10]=Source.[Grade 10],Target.[Subject 11]=Source.[Subject 11],
Target.[Grade 11]=Source.[Grade 11],Target.[Subject 12]=Source.[Subject 12],Target.[Grade 12]=Source.[Grade 12],Target.[Subject 13]=Source.[Subject 13],Target.[Grade 13]=Source.[Grade 13],Target.[Subject 14]=Source.[Subject 14],Target.[Grade 14]=Source.[Grade 14],Target.[Subject 15]=Source.[Subject 15],Target.[Grade 15]=Source.[Grade 15],Target.[Subject 16]=Source.[Subject 16],Target.[Grade 16]=Source.[Grade 16],Target.[Previous JAMB Reg# No]=Source.[Previous JAMB Reg# No],
Target.[Previous JAMB Full Name]=Source.[Previous JAMB Full Name],Target.[Previous JAMB Year]=Source.[Previous JAMB Year],Target.[Previous Industrial Training Period Start]=Source.[Previous Industrial Training Period Start],Target.[Previous Industrial Training Period Ends]=Source.[Previous Industrial Training Period Ends],Target.[Previous Institution Attended]=Source.[Previous Institution Attended],Target.[Previous Course of Study]=Source.[Previous Course of Study],
Target.[Previous Course Type]=Source.[Previous Course Type],Target.[Previous Course Grade]=Source.[Previous Course Grade],Target.[Previous Course Completed Year]=Source.[Previous Course Completed Year],Target.[Previous Secondary School Attended]=Source.[Previous Secondary School Attended],Target.[Previous Secondary School Address]=Source.[Previous Secondary School Address],Target.[Previous Secondary School Start Year]=Source.[Previous Secondary School Start Year],
Target.[Previous Secondary School End Year]=Source.[Previous Secondary School End Year],Target.[Academic_Year]=Source.[Academic_Year],Target.Semester=Source.Semester,Target.StudentType=Source.StudentType,Target.DateUploaded=Source.DateUploaded

when not matched then

Insert (ID,[Form Number],[Academic Program],[Department],[Surname],[First Name],[Other Name],[Gender],[Date of Birth],[Home Address],[Phone Number],[Email Address],[State of Origin],[Local Govt Area],[Picture],[JAMB Reg Number],[JAMB Subjects],[JAMB UTME Score]
           ,[CBT Score],[Admission Score],[First O'Level Exam Type],[First O'Level Exam Month],[First O'Level Exam Number],[First O'Level Exam Year],[Subject 1],[Grade 1],[Subject 2],[Grade 2],[Subject 3],[Grade 3],[Subject 4],[Grade 4],[Subject 5],[Grade 5]
           ,[Subject 6],[Grade 6],[Subject 7],[Grade 7],[Subject 8],[Grade 8],[Second O'Level Exam Type],[Second O'Level Exam Month],[Second O'Level Exam Number],[Second O'Level Exam Year],[Subject 9],[Grade 9],[Subject 10],[Grade 10],[Subject 11],[Grade 11]
           ,[Subject 12],[Grade 12],[Subject 13],[Grade 13],[Subject 14],[Grade 14],[Subject 15],[Grade 15],[Subject 16],[Grade 16],[Previous JAMB Reg# No],[Previous JAMB Full Name],[Previous JAMB Year],[Previous Industrial Training Period Start],[Previous Industrial Training Period Ends]
           ,[Previous Institution Attended],[Previous Course of Study],[Previous Course Type],[Previous Course Grade],[Previous Course Completed Year],[Previous Secondary School Attended],[Previous Secondary School Address],[Previous Secondary School Start Year],[Previous Secondary School End Year]
           ,[Academic_Year],[Semester],[StudentType],[DateUploaded])

Values (Source.ID, Source.[Form Number],Source.[Academic Program],Source.[Department],Source.[Surname],Source.[First Name],Source.[Other Name],Source.[Gender],Source.[Date of Birth],Source.[Home Address],Source.[Phone Number],Source.[Email Address],Source.[State of Origin],Source.[Local Govt Area],Source.[Picture],Source.[JAMB Reg Number],Source.[JAMB Subjects],Source.[JAMB UTME Score]
           ,Source.[CBT Score],Source.[Admission Score],Source.[First O'Level Exam Type],Source.[First O'Level Exam Month],Source.[First O'Level Exam Number],Source.[First O'Level Exam Year],Source.[Subject 1],Source.[Grade 1],Source.[Subject 2],Source.[Grade 2],Source.[Subject 3],Source.[Grade 3],Source.[Subject 4],Source.[Grade 4],Source.[Subject 5],Source.[Grade 5]
           ,Source.[Subject 6],Source.[Grade 6],Source.[Subject 7],Source.[Grade 7],Source.[Subject 8],Source.[Grade 8],Source.[Second O'Level Exam Type],Source.[Second O'Level Exam Month],Source.[Second O'Level Exam Number],Source.[Second O'Level Exam Year],Source.[Subject 9],Source.[Grade 9],Source.[Subject 10],Source.[Grade 10],Source.[Subject 11],Source.[Grade 11]
           ,Source.[Subject 12],Source.[Grade 12],Source.[Subject 13],Source.[Grade 13],Source.[Subject 14],Source.[Grade 14],Source.[Subject 15],Source.[Grade 15],Source.[Subject 16],Source.[Grade 16],Source.[Previous JAMB Reg# No],Source.[Previous JAMB Full Name],Source.[Previous JAMB Year],Source.[Previous Industrial Training Period Start],Source.[Previous Industrial Training Period Ends]
           ,Source.[Previous Institution Attended],Source.[Previous Course of Study],Source.[Previous Course Type],Source.[Previous Course Grade],Source.[Previous Course Completed Year],Source.[Previous Secondary School Attended],Source.[Previous Secondary School Address],Source.[Previous Secondary School Start Year],Source.[Previous Secondary School End Year]
           ,Source.[Academic_Year],Source.[Semester],Source.[StudentType],Source.[DateUploaded]);
SET IDENTITY_INSERT  studentinfo OFF;";